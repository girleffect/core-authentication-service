sudo: required
cache: pip
language: python
python:
- '3.6'
env:
  matrix:
  - TOXENV=django111
  global:
  - secure: xPDQ/QzXYoI3ngxgwMInQM8MRbmevUMyEUbeAiLRcglXW3V5vCen7EdBi0NNM7nqNnZBpZiTuibh/ucIcqLVoFpvHZK6sFfIN7urAB6sPV7gUlVBAq0DYM6Fiyrd/L9o0wrlxOzul+IgaSRhforgV2qj1AacD0QEmLZOeRhIkOg6x91FUjZudVe6hbp6la3PJamrCU90x0Iu6iQCRNTlk5LCY6B/x65cYmxdYN5M1tpH7gRX+3/UWq/In1KoA2r5k7a27D6isye6GUrtnPvvex62Ez83/G3fuwVjRCm5rmclMs79MUgt566uyn4mhCUhe5iqO/9XQYuF22gDy7gBeNBcoURXkmyQbcPMl0vyvkhxFnSHFt1ztaJHmRvmS41blN6aaY5I4r91s2byLClwEOEA4MqF3BiUBf1SD4C1LPWY4Su95zxsage639Sse5XqhjIVNaJifSJG0mV5Cpea/EfKsD3zR/8oxbm+RjN+q3EqzDuqOZ4e42xYpdY+Oa6cDnmCVlZ7qDNx8rZP3sgN5j6akXlzSdOyZCW1Ulnxvt8xeFovgZEvAAh2nQCVir5KtGlutXbkS2vMRmH7wiumSLpa+J2nwoTQViIbeTXOxzRwiqLmvz/ksEtVaj2i90QUO9rr5eT4Bj1R8cCsDnXtnwnD1ICK0XDn2RK5icvcnos=
services:
- docker
- redis-server
- postgresql
addons:
  postgresql: "9.6"
install:
- pip install tox coveralls
script: tox
after_success:
- coveralls
deploy:
- provider: script
  script: bash ./scripts/docker_push.sh
  on:
    branch: master
- provider: script
  script: bash ./scripts/docker_push.sh
  on:
    branch: develop
- provider: script
  script: bash ./scripts/docker_push.sh
  on:
    all_branches: true
    condition: "${TRAVIS_BRANCH} =~ ^release.*$"
